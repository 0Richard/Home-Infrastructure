# =============================================================================
# NSA Server - WireGuard VPN Configuration
# =============================================================================
# Generated by Ansible - Do not edit manually
# Template: templates/nsa-server/wg0.conf.j2
# =============================================================================

[Interface]
Address = {{ wireguard_address }}
ListenPort = {{ wireguard_port }}
PrivateKey = {{ vault_wireguard_private_key }}

# Forwarding and NAT rules are in /etc/nftables.conf (static, always loaded)
# No PostUp/PostDown needed - nftables handles WireGuard traffic permanently

# =============================================================================
# Peers
# =============================================================================
{% for peer in vault_wireguard_peers %}

[Peer]
# {{ peer.name }}
PublicKey = {{ peer.public_key }}
AllowedIPs = {{ peer.allowed_ips }}
{% if peer.keepalive is defined %}
PersistentKeepalive = {{ peer.keepalive }}
{% endif %}
{% endfor %}
